{% extends 'base.html' %}
{% load i18n %}
{% load static %}
{% load customfilters %}
{% load tz %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/library.css' %}">
{% endblock %}

{% block navbar %}
<li class="nav-item">
  <a class="nav-link" href="{% url "addStory" %}" >{% trans "Add story" %}</a>
</li>
{% endblock %}

{% block body %}
{% if latest_stories_list %}
{% for story in latest_stories_list %}
<div class="row story-line no-gutters">
  <div class="col-2">
    <img src="{% get_media_prefix %}{{ story.poster }}" alt="{{ story.title }}" class = "poster img-fluid" />
  </div>
  <div class="col-10">
    <div class="content container-fluid">
      <div class="row">
	<div class="col-sm-12 col-12">  <a class="story-title" href={% url "watchStory" storyId=story.id %}>{{ story.title }}</a> </div>
	<div class="col-sm-3 col-6">  {{ ageDict|get_item:story.age }} </div>
	<div class="col-sm-3 col-6">  {{ languageDict|get_item:story.language }} </div>
	<div class="col-sm-3 col-6">  {% localtime off %}{{ story.pub_date.date }}{% endlocaltime %} </div>
	<div class="col-sm-3 col-6">  
	  <button class="vote" id="downvoteStory{{story.id}}" data-vote="down" data-storyid="{{story.id}}" type="button"
		  {% if not user.is_authenticated %}
		  disabled
		  {% endif %}
		  {% if user in story.downvotes.all  %}
		  style="background-color:green"
		  {% else %}
		  style="background-color:blue"
		  {% endif %}
		  >-</button>
	  <b id="scoreStory{{ story.id }}">{{ story.score }}</b>
	  <button class="vote" id="upvoteStory{{story.id}}" data-vote="up" data-storyid="{{story.id}}" type="button"
		  {% if not user.is_authenticated %}
		  disabled
		  {% endif %}
		  {% if user in story.upvotes.all  %}
		  style="background-color:green"
		  {% else %}
		  style="background-color:blue"
		  {% endif %}
		  >+</button>
	</div>
      </div>
    </div>
  </div>
</div>
{% endfor %}
{% else %}
<p>No story is available.</p>
{% endif %}
{% endblock %}


{% block javascript %}
<script src="{% static '/js/library_vote.js' %}"></script>
{% endblock javascript %}
  
  
